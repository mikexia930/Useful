import{p as G,d as C,s as z}from"./styles-d0b2ab71.2f312555.js";import{l as d,c,h as k,y as P,t as q,r as $,o as I,p as F,j as M}from"./DMarkdown.vue_vue_type_script_setup_true_lang.e94416e7.js";import{G as H}from"./layout.26d23d25.js";import{r as V}from"./index-892ad7fb.f5dcf29f.js";import"./index.faab34ef.js";import"./DButton.vue_vue_type_script_setup_true_lang.cdf87bb8.js";import"./Interface.626ae8f0.js";import"./memoize.4bde03d7.js";import"./_plugin-vue_export-helper.cdc0426e.js";import"./fileLib.41837830.js";import"./hasIn.6feb23c8.js";import"./findIndex.8f62b537.js";import"./_baseIsEqual.35b9df4a.js";import"./_flatRest.64e8233e.js";import"./pick.7ac0dd93.js";import"./now.b82f2ad8.js";import"./last.2965d17e.js";import"./edges-c959041a.3e842cd3.js";import"./createText-b670c180.1af218d9.js";import"./svgDraw-b48a99d5.6f6b445f.js";import"./line.974c1c38.js";import"./array.999c8e45.js";import"./path.e8dbb404.js";const T=s=>M.sanitizeText(s,c());let S={dividerMargin:10,padding:5,textHeight:10,curve:void 0};const W=function(s,o,f,n){const t=Object.keys(s);d.info("keys:",t),d.info(s),t.forEach(function(i){var p;var l,r;const e=s[i],y={shape:"rect",id:e.id,domId:e.domId,labelText:T(e.id),labelStyle:"",style:"fill: none; stroke: black",padding:(p=(l=c().flowchart)==null?void 0:l.padding)!=null?p:(r=c().class)==null?void 0:r.padding};o.setNode(e.id,y),R(e.classes,o,f,n,e.id),d.info("setNode",y)})},R=function(s,o,f,n,t){const i=Object.keys(s);d.info("keys:",i),d.info(s),i.filter(l=>s[l].parent==t).forEach(function(l){var g,m;var r,e;const a=s[l],y=a.cssClasses.join(" "),p={labelStyle:"",style:""},v=(g=a.label)!=null?g:a.id,b=0,h="class_box",u={labelStyle:p.labelStyle,shape:h,labelText:T(v),classData:a,rx:b,ry:b,class:y,style:p.style,id:a.id,domId:a.domId,tooltip:n.db.getTooltip(a.id,t)||"",haveCallback:a.haveCallback,link:a.link,width:a.type==="group"?500:void 0,type:a.type,padding:(m=(r=c().flowchart)==null?void 0:r.padding)!=null?m:(e=c().class)==null?void 0:e.padding};o.setNode(a.id,u),t&&o.setParent(a.id,t),d.info("setNode",u)})},J=function(s,o,f,n){d.info(s),s.forEach(function(t,i){var m;var l,r;const e=t,a="",y={labelStyle:"",style:""},p=e.text,v=0,b="note",h={labelStyle:y.labelStyle,shape:b,labelText:T(p),noteData:e,rx:v,ry:v,class:a,style:y.style,id:e.id,domId:e.id,tooltip:"",type:"note",padding:(m=(l=c().flowchart)==null?void 0:l.padding)!=null?m:(r=c().class)==null?void 0:r.padding};if(o.setNode(e.id,h),d.info("setNode",h),!e.class||!(e.class in n))return;const u=f+i,g={id:`edgeNote${u}`,classes:"relation",pattern:"dotted",arrowhead:"none",startLabelRight:"",endLabelLeft:"",arrowTypeStart:"none",arrowTypeEnd:"none",style:"fill:none",labelStyle:"",curve:$(S.curve,I)};o.setEdge(e.id,e.class,g,u)})},K=function(s,o){const f=c().flowchart;let n=0;s.forEach(function(t){var r;var i;n++;const l={classes:"relation",pattern:t.relation.lineType==1?"dashed":"solid",id:"id"+n,arrowhead:t.type==="arrow_open"?"none":"normal",startLabelRight:t.relationTitle1==="none"?"":t.relationTitle1,endLabelLeft:t.relationTitle2==="none"?"":t.relationTitle2,arrowTypeStart:A(t.relation.type1),arrowTypeEnd:A(t.relation.type2),style:"fill:none",labelStyle:"",curve:$(f==null?void 0:f.curve,I)};if(d.info(l,t),t.style!==void 0){const e=F(t.style);l.style=e.style,l.labelStyle=e.labelStyle}t.text=t.title,t.text===void 0?t.style!==void 0&&(l.arrowheadStyle="fill: #333"):(l.arrowheadStyle="fill: #333",l.labelpos="c",((r=(i=c().flowchart)==null?void 0:i.htmlLabels)!=null?r:c().htmlLabels)?(l.labelType="html",l.label='<span class="edgeLabel">'+t.text+"</span>"):(l.labelType="text",l.label=t.text.replace(M.lineBreakRegex,`
`),t.style===void 0&&(l.style=l.style||"stroke: #333; stroke-width: 1.5px;fill:none"),l.labelStyle=l.labelStyle.replace("color:","fill:"))),o.setEdge(t.id1,t.id2,l,n)})},Q=function(s){S={...S,...s}},U=async function(s,o,f,n){var m,L,N,D;d.info("Drawing class - ",o);const t=(m=c().flowchart)!=null?m:c().class,i=c().securityLevel;d.info("config:",t);const l=(L=t==null?void 0:t.nodeSpacing)!=null?L:50,r=(N=t==null?void 0:t.rankSpacing)!=null?N:50,e=new H({multigraph:!0,compound:!0}).setGraph({rankdir:n.db.getDirection(),nodesep:l,ranksep:r,marginx:8,marginy:8}).setDefaultEdgeLabel(function(){return{}}),a=n.db.getNamespaces(),y=n.db.getClasses(),p=n.db.getRelations(),v=n.db.getNotes();d.info(p),W(a,e,o,n),R(y,e,o,n),K(p,e),J(v,e,p.length+1,y);let b;i==="sandbox"&&(b=k("#i"+o));const h=i==="sandbox"?k(b.nodes()[0].contentDocument.body):k("body"),u=h.select(`[id="${o}"]`),g=h.select("#"+o+" g");if(await V(g,e,["aggregation","extension","composition","dependency","lollipop"],"classDiagram",o),P.insertTitle(u,"classTitleText",(D=t==null?void 0:t.titleTopMargin)!=null?D:5,n.db.getDiagramTitle()),q(e,u,t==null?void 0:t.diagramPadding,t==null?void 0:t.useMaxWidth),!(t!=null&&t.htmlLabels)){const E=i==="sandbox"?b.nodes()[0].contentDocument:document,B=E.querySelectorAll('[id="'+o+'"] .edgeLabel .label');for(const w of B){const _=w.getBBox(),x=E.createElementNS("http://www.w3.org/2000/svg","rect");x.setAttribute("rx",0),x.setAttribute("ry",0),x.setAttribute("width",_.width),x.setAttribute("height",_.height),w.insertBefore(x,w.firstChild)}}};function A(s){let o;switch(s){case 0:o="aggregation";break;case 1:o="extension";break;case 2:o="composition";break;case 3:o="dependency";break;case 4:o="lollipop";break;default:o="none"}return o}const X={setConf:Q,draw:U},gt={parser:G,db:C,renderer:X,styles:z,init:s=>{s.class||(s.class={}),s.class.arrowMarkerAbsolute=s.arrowMarkerAbsolute,C.clear()}};export{gt as diagram};
