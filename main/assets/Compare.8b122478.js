import{b as Ye,c as je,a as qe,d as xe,e as er,U as rr}from"./UICreateImport.vue_vue_type_script_setup_true_lang.6448cfe4.js";import{U as tr}from"./UIWithTitle.d993fdee.js";import{r as nr,X as ir}from"./codemirror.adfb2e3e.js";import{q as Re,d as ye,K as De,be as ar,a4 as j,t as lr,o as ne,c as pe,a as x,bf as ve,S as K,b as sr,g as ie,w as oe,$ as R,at as or,v as fe,y as we,a0 as fr,a1 as hr,x as ke}from"./index.3ab85725.js";import{u as gr}from"./ModuleAutoSaveLib.819c944f.js";import{_ as Ue}from"./_plugin-vue_export-helper.cdc0426e.js";import{_ as ur}from"./DButton.vue_vue_type_script_setup_true_lang.e2f82be7.js";import{u as cr,a as vr}from"./PortImport.vue_vue_type_script_setup_true_lang.43cdc101.js";import{_ as mr,a as pr}from"./Interface.c6a03467.js";import{d as Ce}from"./copyLib.ca75e804.js";import"./DTooltip.5a9330cf.js";import"./_baseIsEqual.7a45aebd.js";import"./ModuleCollapsetLib.a0088d00.js";import"./routeLib.37d6b3c0.js";import"./findIndex.6a8df10b.js";import"./hasIn.c2b708ee.js";import"./memoize.1e077d83.js";import"./index.d6d46cb8.js";import"./KeyCode.9e37adda.js";import"./pick.149312ef.js";import"./_flatRest.22990ff9.js";import"./DSelect.vue_vue_type_script_setup_true_lang.bd143388.js";import"./styleChecker.c933fe21.js";import"./debounce.bdc79bae.js";import"./now.7049a2dd.js";import"./DResult.vue_vue_type_script_setup_true_lang.ce81bdf8.js";import"./fileLib.8b45b5bc.js";import"./DSpin.cd17200b.js";import"./config.aa76b2c0.js";import"./randomLib.04c6c9cc.js";import"./stringify.15412eb9.js";(function(ee,p){(function(C){C(nr())})(function(C){var y=C.Pos,S="http://www.w3.org/2000/svg";function r(e,n){this.mv=e,this.type=n,this.classes=n=="left"?{chunk:"CodeMirror-merge-l-chunk",start:"CodeMirror-merge-l-chunk-start",end:"CodeMirror-merge-l-chunk-end",insert:"CodeMirror-merge-l-inserted",del:"CodeMirror-merge-l-deleted",connect:"CodeMirror-merge-l-connect"}:{chunk:"CodeMirror-merge-r-chunk",start:"CodeMirror-merge-r-chunk-start",end:"CodeMirror-merge-r-chunk-end",insert:"CodeMirror-merge-r-inserted",del:"CodeMirror-merge-r-deleted",connect:"CodeMirror-merge-r-connect"}}r.prototype={constructor:r,init:function(e,n,l){this.edit=this.mv.edit,(this.edit.state.diffViews||(this.edit.state.diffViews=[])).push(this),this.orig=C(e,de({value:n,readOnly:!this.mv.options.allowEditingOriginals},de(l))),this.mv.options.connect=="align"&&(this.edit.state.trackAlignable||(this.edit.state.trackAlignable=new _e(this.edit)),this.orig.state.trackAlignable=new _e(this.orig)),this.lockButton.title=this.edit.phrase("Toggle locked scrolling"),this.lockButton.setAttribute("aria-label",this.lockButton.title),this.orig.state.diffViews=[this];var h=l.chunkClassLocation||"background";Object.prototype.toString.call(h)!="[object Array]"&&(h=[h]),this.classes.classLocation=h,this.diff=he(H(n),H(l.value),this.mv.options.ignoreWhitespace),this.chunks=Me(this.diff),this.diffOutOfDate=this.dealigned=!1,this.needsScrollSync=null,this.showDifferences=l.showDifferences!==!1},registerEvents:function(e){this.forceUpdate=s(this),c(this,!0,!1),o(this,e)},setShowDifferences:function(e){e=e!==!1,e!=this.showDifferences&&(this.showDifferences=e,this.forceUpdate("full"))}};function t(e){e.diffOutOfDate&&(e.diff=he(e.orig.getValue(),e.edit.getValue(),e.mv.options.ignoreWhitespace),e.chunks=Me(e.diff),e.diffOutOfDate=!1,C.signal(e.edit,"updateDiff",e.diff))}var i=!1;function s(e){var n={from:0,to:0,marked:[]},l={from:0,to:0,marked:[]},h,g=!1;function u(A){i=!0,g=!1,A=="full"&&(e.svg&&ge(e.svg),e.copyButtons&&ge(e.copyButtons),b(e.edit,n.marked,e.classes),b(e.orig,l.marked,e.classes),n.from=n.to=l.from=l.to=0),t(e),e.showDifferences&&(w(e.edit,e.diff,n,DIFF_INSERT,e.classes),w(e.orig,e.diff,l,DIFF_DELETE,e.classes)),e.mv.options.connect=="align"&&L(e),k(e),e.needsScrollSync!=null&&a(e,e.needsScrollSync),i=!1}function m(A){i||(e.dealigned=!0,d(A))}function d(A){i||g||(clearTimeout(h),A===!0&&(g=!0),h=setTimeout(u,A===!0?20:250))}function _(A,O){e.diffOutOfDate||(e.diffOutOfDate=!0,n.from=n.to=l.from=l.to=0),m(O.text.length-1!=O.to.line-O.from.line)}function F(){e.diffOutOfDate=!0,e.dealigned=!0,u("full")}return e.edit.on("change",_),e.orig.on("change",_),e.edit.on("swapDoc",F),e.orig.on("swapDoc",F),e.mv.options.connect=="align"&&(C.on(e.edit.state.trackAlignable,"realign",m),C.on(e.orig.state.trackAlignable,"realign",m)),e.edit.on("viewportChange",function(){d(!1)}),e.orig.on("viewportChange",function(){d(!1)}),u(),u}function o(e,n){e.edit.on("scroll",function(){a(e,!0)&&k(e)}),e.orig.on("scroll",function(){a(e,!1)&&k(e),n&&a(n,!0)&&k(n)})}function a(e,n){if(e.diffOutOfDate)return e.lockScroll&&e.needsScrollSync==null&&(e.needsScrollSync=n),!1;if(e.needsScrollSync=null,!e.lockScroll)return!0;var l,h,g=+new Date;if(n?(l=e.edit,h=e.orig):(l=e.orig,h=e.edit),l.state.scrollSetBy==e&&(l.state.scrollSetAt||0)+250>g)return!1;var u=l.getScrollInfo();if(e.mv.options.connect=="align")$=u.top;else{var m=.5*u.clientHeight,d=u.top+m,_=l.lineAtHeight(d,"local"),F=Ve(e.chunks,_,n),A=f(l,n?F.edit:F.orig),O=f(h,n?F.orig:F.edit),z=(d-A.top)/(A.bot-A.top),$=O.top-m+z*(O.bot-O.top),Q,Z;if($>u.top&&(Z=u.top/m)<1)$=$*Z+u.top*(1-Z);else if((Q=u.height-u.clientHeight-u.top)<m){var Y=h.getScrollInfo(),G=Y.height-Y.clientHeight-$;G>Q&&(Z=Q/m)<1&&($=$*Z+(Y.height-Y.clientHeight-Q)*(1-Z))}}return h.scrollTo(u.left,$),h.state.scrollSetAt=g,h.state.scrollSetBy=e,!0}function f(e,n){var l=n.after;return l==null&&(l=e.lastLine()+1),{top:e.heightAtLine(n.before||0,"local"),bot:e.heightAtLine(l,"local")}}function c(e,n,l){e.lockScroll=n,n&&l!=!1&&a(e,DIFF_INSERT)&&k(e),(n?C.addClass:C.rmClass)(e.lockButton,"CodeMirror-merge-scrolllock-enabled")}function v(e,n,l){for(var h=l.classLocation,g=0;g<h.length;g++)e.removeLineClass(n,h[g],l.chunk),e.removeLineClass(n,h[g],l.start),e.removeLineClass(n,h[g],l.end)}function b(e,n,l){for(var h=0;h<n.length;++h){var g=n[h];g instanceof C.TextMarker?g.clear():g.parent&&v(e,g,l)}n.length=0}function w(e,n,l,h,g){var u=e.getViewport();e.operation(function(){l.from==l.to||u.from-l.to>20||l.from-u.to>20?(b(e,l.marked,g),M(e,n,h,l.marked,u.from,u.to,g),l.from=u.from,l.to=u.to):(u.from<l.from&&(M(e,n,h,l.marked,u.from,l.from,g),l.from=u.from),u.to>l.to&&(M(e,n,h,l.marked,l.to,u.to,g),l.to=u.to))})}function D(e,n,l,h,g,u){for(var m=l.classLocation,d=e.getLineHandle(n),_=0;_<m.length;_++)h&&e.addLineClass(d,m[_],l.chunk),g&&e.addLineClass(d,m[_],l.start),u&&e.addLineClass(d,m[_],l.end);return d}function M(e,n,l,h,g,u,m){var d=y(0,0),_=y(g,0),F=e.clipPos(y(u-1)),A=l==DIFF_DELETE?m.del:m.insert;function O(be,ae){for(var le=Math.max(g,be),We=Math.min(u,ae),se=le;se<We;++se)h.push(D(e,se,m,!0,se==be,se==ae-1));be==ae&&le==ae&&We==ae&&(le?h.push(D(e,le-1,m,!1,!1,!0)):h.push(D(e,le,m,!1,!0,!1)))}for(var z=0,$=!1,Q=0;Q<n.length;++Q){var Z=n[Q],Y=Z[0],G=Z[1];if(Y==DIFF_EQUAL){var Be=d.line+(Fe(n,Q)?0:1);ue(d,G);var Le=d.line+(Se(n,Q)?1:0);Le>Be&&($&&(O(z,Be),$=!1),z=Le)}else if($=!0,Y==l){var Ne=ue(d,G,!0),Oe=Xe(_,d),Pe=Ge(F,Ne);Ke(Oe,Pe)||h.push(e.markText(Oe,Pe,{className:A})),d=Ne}}$&&O(z,d.line+1)}function k(e){if(!!e.showDifferences){if(e.svg){ge(e.svg);var n=e.gap.offsetWidth;Ae(e.svg,"width",n,"height",e.gap.offsetHeight)}e.copyButtons&&ge(e.copyButtons);for(var l=e.edit.getViewport(),h=e.orig.getViewport(),g=e.mv.wrap.getBoundingClientRect().top,u=g-e.edit.getScrollerElement().getBoundingClientRect().top+e.edit.getScrollInfo().top,m=g-e.orig.getScrollerElement().getBoundingClientRect().top+e.orig.getScrollInfo().top,d=0;d<e.chunks.length;d++){var _=e.chunks[d];_.editFrom<=l.to&&_.editTo>=l.from&&_.origFrom<=h.to&&_.origTo>=h.from&&X(e,_,m,u,n)}}}function E(e,n){for(var l=0,h=0,g=0;g<n.length;g++){var u=n[g];if(u.editTo>e&&u.editFrom<=e)return null;if(u.editFrom>e)break;l=u.editTo,h=u.origTo}return h+(e-l)}function I(e,n,l){for(var h=e.state.trackAlignable,g=e.firstLine(),u=0,m=[],d=0;;d++){for(var _=n[d],F=_?l?_.origFrom:_.editFrom:1e9;u<h.alignable.length;u+=2){var A=h.alignable[u]+1;if(!(A<=g))if(A<=F)m.push(A);else break}if(!_)break;m.push(g=l?_.origTo:_.editTo)}return m}function U(e,n,l,h){var g=0,u=0,m=0,d=0;e:for(;;g++){var _=e[g],F=n[u];if(!_&&F==null)break;for(var A=_?_[0]:1e9,O=F==null?1e9:F;m<l.length;){var z=l[m];if(z.origFrom<=O&&z.origTo>O){u++,g--;continue e}if(z.editTo>A){if(z.editFrom<=A)continue e;break}d+=z.origTo-z.origFrom-(z.editTo-z.editFrom),m++}if(A==O-d)_[h]=O,u++;else if(A<O-d)_[h]=A+d;else{var $=[O-d,null,null];$[h]=O,e.splice(g,0,$),u++}}}function B(e,n){var l=I(e.edit,e.chunks,!1),h=[];if(n)for(var g=0,u=0;g<n.chunks.length;g++){for(var m=n.chunks[g].editTo;u<l.length&&l[u]<m;)u++;(u==l.length||l[u]!=m)&&l.splice(u++,0,m)}for(var g=0;g<l.length;g++)h.push([l[g],null,null]);return U(h,I(e.orig,e.chunks,!0),e.chunks,1),n&&U(h,I(n.orig,n.chunks,!0),n.chunks,2),h}function L(e,n){if(!(!e.dealigned&&!n)){if(!e.orig.curOp)return e.orig.operation(function(){L(e,n)});e.dealigned=!1;var l=e.mv.left==e?e.mv.right:e.mv.left;l&&(t(l),l.dealigned=!1);for(var h=B(e,l),g=e.mv.aligners,u=0;u<g.length;u++)g[u].clear();g.length=0;var m=[e.edit,e.orig],d=[],_=[];l&&m.push(l.orig);for(var u=0;u<m.length;u++)d.push(m[u].getScrollInfo().top),_.push(-m[u].getScrollerElement().getBoundingClientRect().top);(_[0]!=_[1]||m.length==3&&_[1]!=_[2])&&P(m,_,[0,0,0],g);for(var F=0;F<h.length;F++)P(m,_,h[F],g);for(var u=0;u<m.length;u++)m[u].scrollTo(null,d[u])}}function P(e,n,l,h){for(var g=-1e8,u=[],m=0;m<e.length;m++)if(l[m]!=null){var d=e[m].heightAtLine(l[m],"local")-n[m];u[m]=d,g=Math.max(g,d)}for(var m=0;m<e.length;m++)if(l[m]!=null){var _=g-u[m];_>1&&h.push(W(e[m],l[m],_))}}function W(e,n,l){var h=!0;n>e.lastLine()&&(n--,h=!1);var g=document.createElement("div");return g.className="CodeMirror-merge-spacer",g.style.height=l+"px",g.style.minWidth="1px",e.addLineWidget(n,g,{height:l,above:h,mergeSpacer:!0,handleMouseEvents:!0})}function X(e,n,l,h,g){var u=e.type=="left",m=e.orig.heightAtLine(n.origFrom,"local",!0)-l;if(e.svg){var d=m,_=e.edit.heightAtLine(n.editFrom,"local",!0)-h;if(u){var F=d;d=_,_=F}var A=e.orig.heightAtLine(n.origTo,"local",!0)-l,O=e.edit.heightAtLine(n.editTo,"local",!0)-h;if(u){var F=A;A=O,O=F}var z=" C "+g/2+" "+_+" "+g/2+" "+d+" "+(g+2)+" "+d,$=" C "+g/2+" "+A+" "+g/2+" "+O+" -1 "+O;Ae(e.svg.appendChild(document.createElementNS(S,"path")),"d","M -1 "+_+z+" L "+(g+2)+" "+A+$+" z","class",e.classes.connect)}if(e.copyButtons){var Q=e.copyButtons.appendChild(J("div",e.type=="left"?"\u21DD":"\u21DC","CodeMirror-merge-copy")),Z=e.mv.options.allowEditingOriginals;if(Q.title=e.edit.phrase(Z?"Push to left":"Revert chunk"),Q.chunk=n,Q.style.top=(n.origTo>n.origFrom?m:e.edit.heightAtLine(n.editFrom,"local")-h)+"px",Q.setAttribute("role","button"),Q.setAttribute("tabindex","0"),Q.setAttribute("aria-label",Q.title),Z){var Y=e.edit.heightAtLine(n.editFrom,"local")-h,G=e.copyButtons.appendChild(J("div",e.type=="right"?"\u21DD":"\u21DC","CodeMirror-merge-copy-reverse"));G.title="Push to right",G.chunk={editFrom:n.origFrom,editTo:n.origTo,origFrom:n.editFrom,origTo:n.editTo},G.style.top=Y+"px",e.type=="right"?G.style.left="2px":G.style.right="2px",G.setAttribute("role","button"),G.setAttribute("tabindex","0"),G.setAttribute("aria-label",G.title)}}}function V(e,n,l,h){if(!e.diffOutOfDate){var g=h.origTo>l.lastLine()?y(h.origFrom-1):y(h.origFrom,0),u=y(h.origTo,0),m=h.editTo>n.lastLine()?y(h.editFrom-1):y(h.editFrom,0),d=y(h.editTo,0),_=e.mv.options.revertChunk;_?_(e.mv,l,g,u,n,m,d):n.replaceRange(l.getRange(g,u),m,d)}}var T=C.MergeView=function(e,n){if(!(this instanceof T))return new T(e,n);this.options=n;var l=n.origLeft,h=n.origRight==null?n.orig:n.origRight,g=l!=null,u=h!=null,m=1+(g?1:0)+(u?1:0),d=[],_=this.left=null,F=this.right=null,A=this;if(g){_=this.left=new r(this,"left");var O=J("div",null,"CodeMirror-merge-pane CodeMirror-merge-left");d.push(O),d.push(N(_))}var z=J("div",null,"CodeMirror-merge-pane CodeMirror-merge-editor");if(d.push(z),u){F=this.right=new r(this,"right"),d.push(N(F));var $=J("div",null,"CodeMirror-merge-pane CodeMirror-merge-right");d.push($)}(u?$:z).className+=" CodeMirror-merge-pane-rightmost",d.push(J("div",null,null,"height: 0; clear: both;"));var Q=this.wrap=e.appendChild(J("div",d,"CodeMirror-merge CodeMirror-merge-"+m+"pane"));this.edit=C(z,de(n)),_&&_.init(O,l,n),F&&F.init($,h,n),n.collapseIdentical&&this.editor().operation(function(){Qe(A,n.collapseIdentical)}),n.connect=="align"&&(this.aligners=[],L(this.left||this.right,!0)),_&&_.registerEvents(F),F&&F.registerEvents(_);var Z=function(){_&&k(_),F&&k(F)};C.on(window,"resize",Z);var Y=setInterval(function(){for(var G=Q.parentNode;G&&G!=document.body;G=G.parentNode);G||(clearInterval(Y),C.off(window,"resize",Z))},5e3)};function N(e){var n=e.lockButton=J("div",null,"CodeMirror-merge-scrolllock");n.setAttribute("role","button"),n.setAttribute("tabindex","0");var l=J("div",[n],"CodeMirror-merge-scrolllock-wrap");C.on(n,"click",function(){c(e,!e.lockScroll)}),C.on(n,"keyup",function(m){(m.key==="Enter"||m.code==="Space")&&c(e,!e.lockScroll)});var h=[l];if(e.mv.options.revertButtons!==!1){e.copyButtons=J("div",null,"CodeMirror-merge-copybuttons-"+e.type);var g=function(m){var d=m.target||m.srcElement;if(!!d.chunk){if(d.className=="CodeMirror-merge-copy-reverse"){V(e,e.orig,e.edit,d.chunk);return}V(e,e.edit,e.orig,d.chunk)}};C.on(e.copyButtons,"click",g),C.on(e.copyButtons,"keyup",function(m){(m.key==="Enter"||m.code==="Space")&&g(m)}),h.unshift(e.copyButtons)}if(e.mv.options.connect!="align"){var u=document.createElementNS&&document.createElementNS(S,"svg");u&&!u.createSVGRect&&(u=null),e.svg=u,u&&h.push(u)}return e.gap=J("div",h,"CodeMirror-merge-gap")}T.prototype={constructor:T,editor:function(){return this.edit},rightOriginal:function(){return this.right&&this.right.orig},leftOriginal:function(){return this.left&&this.left.orig},setShowDifferences:function(e){this.right&&this.right.setShowDifferences(e),this.left&&this.left.setShowDifferences(e)},rightChunks:function(){if(this.right)return t(this.right),this.right.chunks},leftChunks:function(){if(this.left)return t(this.left),this.left.chunks}};function H(e){return typeof e=="string"?e:e.getValue()}var re;function he(e,n,l){re||(re=new diff_match_patch);for(var h=re.diff_main(e,n),g=0;g<h.length;++g){var u=h[g];(l?!/[^ \t]/.test(u[1]):!u[1])?h.splice(g--,1):g&&h[g-1][0]==u[0]&&(h.splice(g--,1),h[g][1]+=u[1])}return h}function Me(e){var n=[];if(!e.length)return n;for(var l=0,h=0,g=y(0,0),u=y(0,0),m=0;m<e.length;++m){var d=e[m],_=d[0];if(_==DIFF_EQUAL){var F=!Fe(e,m)||g.line<l||u.line<h?1:0,A=g.line+F,O=u.line+F;ue(g,d[1],null,u);var z=Se(e,m)?1:0,$=g.line+z,Q=u.line+z;$>A&&(m&&n.push({origFrom:h,origTo:O,editFrom:l,editTo:A}),l=$,h=Q)}else ue(_==DIFF_INSERT?g:u,d[1])}return(l<=g.line||h<=u.line)&&n.push({origFrom:h,origTo:u.line+1,editFrom:l,editTo:g.line+1}),n}function Se(e,n){if(n==e.length-1)return!0;var l=e[n+1][1];return l.length==1&&n<e.length-2||l.charCodeAt(0)!=10?!1:n==e.length-2?!0:(l=e[n+2][1],(l.length>1||n==e.length-3)&&l.charCodeAt(0)==10)}function Fe(e,n){if(n==0)return!0;var l=e[n-1][1];return l.charCodeAt(l.length-1)!=10?!1:n==1?!0:(l=e[n-2][1],l.charCodeAt(l.length-1)==10)}function Ve(e,n,l){for(var h,g,u,m,d=0;d<e.length;d++){var _=e[d],F=l?_.editFrom:_.origFrom,A=l?_.editTo:_.origTo;g==null&&(F>n?(g=_.editFrom,m=_.origFrom):A>n&&(g=_.editTo,m=_.origTo)),A<=n?(h=_.editTo,u=_.origTo):F<=n&&(h=_.editFrom,u=_.origFrom)}return{edit:{before:h,after:g},orig:{before:u,after:m}}}function He(e,n,l){e.addLineClass(n,"wrap","CodeMirror-merge-collapsed-line");var h=document.createElement("span");h.className="CodeMirror-merge-collapsed-widget",h.title=e.phrase("Identical text collapsed. Click to expand.");var g=e.markText(y(n,0),y(l-1),{inclusiveLeft:!0,inclusiveRight:!0,replacedWith:h,clearOnEnter:!0});function u(){g.clear(),e.removeLineClass(n,"wrap","CodeMirror-merge-collapsed-line")}return g.explicitlyCleared&&u(),C.on(h,"click",u),g.on("clear",u),C.on(h,"click",u),{mark:g,clear:u}}function ze(e,n){var l=[];function h(){for(var d=0;d<l.length;d++)l[d].clear()}for(var g=0;g<n.length;g++){var u=n[g],m=He(u.cm,u.line,u.line+e);l.push(m),m.mark.on("clear",h)}return l[0].mark}function Te(e,n,l,h){for(var g=0;g<e.chunks.length;g++)for(var u=e.chunks[g],m=u.editFrom-n;m<u.editTo+n;m++){var d=m+l;d>=0&&d<h.length&&(h[d]=!1)}}function Qe(e,n){typeof n!="number"&&(n=2);for(var l=[],h=e.editor(),g=h.firstLine(),u=g,m=h.lastLine();u<=m;u++)l.push(!0);e.left&&Te(e.left,n,g,l),e.right&&Te(e.right,n,g,l);for(var d=0;d<l.length;d++)if(l[d]){for(var _=d+g,F=1;d<l.length-1&&l[d+1];d++,F++);if(F>n){var A=[{line:_,cm:h}];e.left&&A.push({line:E(_,e.left.chunks),cm:e.left.orig}),e.right&&A.push({line:E(_,e.right.chunks),cm:e.right.orig});var O=ze(F,A);e.options.onCollapse&&e.options.onCollapse(e,_,F,O)}}}function J(e,n,l,h){var g=document.createElement(e);if(l&&(g.className=l),h&&(g.style.cssText=h),typeof n=="string")g.appendChild(document.createTextNode(n));else if(n)for(var u=0;u<n.length;++u)g.appendChild(n[u]);return g}function ge(e){for(var n=e.childNodes.length;n>0;--n)e.removeChild(e.firstChild)}function Ae(e){for(var n=1;n<arguments.length;n+=2)e.setAttribute(arguments[n],arguments[n+1])}function de(e,n){n||(n={});for(var l in e)e.hasOwnProperty(l)&&(n[l]=e[l]);return n}function ue(e,n,l,h){for(var g=l?y(e.line,e.ch):e,u=0;;){var m=n.indexOf(`
`,u);if(m==-1)break;++g.line,h&&++h.line,u=m+1}return g.ch=(u?0:g.ch)+(n.length-u),h&&(h.ch=(u?0:h.ch)+(n.length-u)),g}var Ee=1,te=2,ce=4;function _e(e){this.cm=e,this.alignable=[],this.height=e.doc.height;var n=this;e.on("markerAdded",function(l,h){if(!!h.collapsed){var g=h.find(1);g!=null&&n.set(g.line,ce)}}),e.on("markerCleared",function(l,h,g,u){u!=null&&h.collapsed&&n.check(u,ce,n.hasMarker)}),e.on("markerChanged",this.signal.bind(this)),e.on("lineWidgetAdded",function(l,h,g){h.mergeSpacer||(h.above?n.set(g-1,te):n.set(g,Ee))}),e.on("lineWidgetCleared",function(l,h,g){h.mergeSpacer||(h.above?n.check(g-1,te,n.hasWidgetBelow):n.check(g,Ee,n.hasWidget))}),e.on("lineWidgetChanged",this.signal.bind(this)),e.on("change",function(l,h){var g=h.from.line,u=h.to.line-h.from.line,m=h.text.length-1,d=g+m;(u||m)&&n.map(g,u,m),n.check(d,ce,n.hasMarker),(u||m)&&n.check(h.from.line,ce,n.hasMarker)}),e.on("viewportChange",function(){n.cm.doc.height!=n.height&&n.signal()})}_e.prototype={signal:function(){C.signal(this,"realign"),this.height=this.cm.doc.height},set:function(e,n){for(var l=-1;l<this.alignable.length;l+=2){var h=this.alignable[l]-e;if(h==0){if((this.alignable[l+1]&n)==n)return;this.alignable[l+1]|=n,this.signal();return}if(h>0)break}this.signal(),this.alignable.splice(l,0,e,n)},find:function(e){for(var n=0;n<this.alignable.length;n+=2)if(this.alignable[n]==e)return n;return-1},check:function(e,n,l){var h=this.find(e);if(!(h==-1||!(this.alignable[h+1]&n))&&!l.call(this,e)){this.signal();var g=this.alignable[h+1]&~n;g?this.alignable[h+1]=g:this.alignable.splice(h,2)}},hasMarker:function(e){var n=this.cm.getLineHandle(e);if(n.markedSpans){for(var l=0;l<n.markedSpans.length;l++)if(n.markedSpans[l].marker.collapsed&&n.markedSpans[l].to!=null)return!0}return!1},hasWidget:function(e){var n=this.cm.getLineHandle(e);if(n.widgets){for(var l=0;l<n.widgets.length;l++)if(!n.widgets[l].above&&!n.widgets[l].mergeSpacer)return!0}return!1},hasWidgetBelow:function(e){if(e==this.cm.lastLine())return!1;var n=this.cm.getLineHandle(e+1);if(n.widgets){for(var l=0;l<n.widgets.length;l++)if(n.widgets[l].above&&!n.widgets[l].mergeSpacer)return!0}return!1},map:function(e,n,l){for(var h=l-n,g=e+n,u=-1,m=-1,d=0;d<this.alignable.length;d+=2){var _=this.alignable[d];_==e&&this.alignable[d+1]&te&&(u=d),_==g&&this.alignable[d+1]&te&&(m=d),!(_<=e)&&(_<g?this.alignable.splice(d--,2):this.alignable[d]+=h)}if(u>-1){var F=this.alignable[u+1];F==te?this.alignable.splice(u,2):this.alignable[u+1]=F&~te}m>-1&&l&&this.set(e+l,te)}};function Ge(e,n){return(e.line-n.line||e.ch-n.ch)<0?e:n}function Xe(e,n){return(e.line-n.line||e.ch-n.ch)>0?e:n}function Ke(e,n){return e.line==n.line&&e.ch==n.ch}function Ze(e,n,l){for(var h=e.length-1;h>=0;h--){var g=e[h],u=(l?g.origTo:g.editTo)-1;if(u<n)return u}}function Je(e,n,l){for(var h=0;h<e.length;h++){var g=e[h],u=l?g.origFrom:g.editFrom;if(u>n)return u}}function Ie(e,n){var l=null,h=e.state.diffViews,g=e.getCursor().line;if(h)for(var u=0;u<h.length;u++){var m=h[u],d=e==m.orig;t(m);var _=n<0?Ze(m.chunks,g,d):Je(m.chunks,g,d);_!=null&&(l==null||(n<0?_>l:_<l))&&(l=_)}if(l!=null)e.setCursor(l,0);else return C.Pass}C.commands.goNextDiff=function(e){return Ie(e,1)},C.commands.goPrevDiff=function(e){return Ie(e,-1)}})})();var $e={exports:{}};(function(ee){var p=function(){this.Diff_Timeout=1,this.Diff_EditCost=4,this.Match_Threshold=.5,this.Match_Distance=1e3,this.Patch_DeleteThreshold=.5,this.Patch_Margin=4,this.Match_MaxBits=32},C=-1,y=1,S=0;p.Diff=function(r,t){return[r,t]},p.prototype.diff_main=function(r,t,i,s){typeof s>"u"&&(this.Diff_Timeout<=0?s=Number.MAX_VALUE:s=new Date().getTime()+this.Diff_Timeout*1e3);var o=s;if(r==null||t==null)throw new Error("Null input. (diff_main)");if(r==t)return r?[new p.Diff(S,r)]:[];typeof i>"u"&&(i=!0);var a=i,f=this.diff_commonPrefix(r,t),c=r.substring(0,f);r=r.substring(f),t=t.substring(f),f=this.diff_commonSuffix(r,t);var v=r.substring(r.length-f);r=r.substring(0,r.length-f),t=t.substring(0,t.length-f);var b=this.diff_compute_(r,t,a,o);return c&&b.unshift(new p.Diff(S,c)),v&&b.push(new p.Diff(S,v)),this.diff_cleanupMerge(b),b},p.prototype.diff_compute_=function(r,t,i,s){var o;if(!r)return[new p.Diff(y,t)];if(!t)return[new p.Diff(C,r)];var a=r.length>t.length?r:t,f=r.length>t.length?t:r,c=a.indexOf(f);if(c!=-1)return o=[new p.Diff(y,a.substring(0,c)),new p.Diff(S,f),new p.Diff(y,a.substring(c+f.length))],r.length>t.length&&(o[0][0]=o[2][0]=C),o;if(f.length==1)return[new p.Diff(C,r),new p.Diff(y,t)];var v=this.diff_halfMatch_(r,t);if(v){var b=v[0],w=v[1],D=v[2],M=v[3],k=v[4],E=this.diff_main(b,D,i,s),I=this.diff_main(w,M,i,s);return E.concat([new p.Diff(S,k)],I)}return i&&r.length>100&&t.length>100?this.diff_lineMode_(r,t,s):this.diff_bisect_(r,t,s)},p.prototype.diff_lineMode_=function(r,t,i){var s=this.diff_linesToChars_(r,t);r=s.chars1,t=s.chars2;var o=s.lineArray,a=this.diff_main(r,t,!1,i);this.diff_charsToLines_(a,o),this.diff_cleanupSemantic(a),a.push(new p.Diff(S,""));for(var f=0,c=0,v=0,b="",w="";f<a.length;){switch(a[f][0]){case y:v++,w+=a[f][1];break;case C:c++,b+=a[f][1];break;case S:if(c>=1&&v>=1){a.splice(f-c-v,c+v),f=f-c-v;for(var D=this.diff_main(b,w,!1,i),M=D.length-1;M>=0;M--)a.splice(f,0,D[M]);f=f+D.length}v=0,c=0,b="",w="";break}f++}return a.pop(),a},p.prototype.diff_bisect_=function(r,t,i){for(var s=r.length,o=t.length,a=Math.ceil((s+o)/2),f=a,c=2*a,v=new Array(c),b=new Array(c),w=0;w<c;w++)v[w]=-1,b[w]=-1;v[f+1]=0,b[f+1]=0;for(var D=s-o,M=D%2!=0,k=0,E=0,I=0,U=0,B=0;B<a&&!(new Date().getTime()>i);B++){for(var L=-B+k;L<=B-E;L+=2){var P=f+L,W;L==-B||L!=B&&v[P-1]<v[P+1]?W=v[P+1]:W=v[P-1]+1;for(var X=W-L;W<s&&X<o&&r.charAt(W)==t.charAt(X);)W++,X++;if(v[P]=W,W>s)E+=2;else if(X>o)k+=2;else if(M){var V=f+D-L;if(V>=0&&V<c&&b[V]!=-1){var T=s-b[V];if(W>=T)return this.diff_bisectSplit_(r,t,W,X,i)}}}for(var N=-B+I;N<=B-U;N+=2){var V=f+N,T;N==-B||N!=B&&b[V-1]<b[V+1]?T=b[V+1]:T=b[V-1]+1;for(var H=T-N;T<s&&H<o&&r.charAt(s-T-1)==t.charAt(o-H-1);)T++,H++;if(b[V]=T,T>s)U+=2;else if(H>o)I+=2;else if(!M){var P=f+D-N;if(P>=0&&P<c&&v[P]!=-1){var W=v[P],X=f+W-P;if(T=s-T,W>=T)return this.diff_bisectSplit_(r,t,W,X,i)}}}}return[new p.Diff(C,r),new p.Diff(y,t)]},p.prototype.diff_bisectSplit_=function(r,t,i,s,o){var a=r.substring(0,i),f=t.substring(0,s),c=r.substring(i),v=t.substring(s),b=this.diff_main(a,f,!1,o),w=this.diff_main(c,v,!1,o);return b.concat(w)},p.prototype.diff_linesToChars_=function(r,t){var i=[],s={};i[0]="";function o(v){for(var b="",w=0,D=-1,M=i.length;D<v.length-1;){D=v.indexOf(`
`,w),D==-1&&(D=v.length-1);var k=v.substring(w,D+1);(s.hasOwnProperty?s.hasOwnProperty(k):s[k]!==void 0)?b+=String.fromCharCode(s[k]):(M==a&&(k=v.substring(w),D=v.length),b+=String.fromCharCode(M),s[k]=M,i[M++]=k),w=D+1}return b}var a=4e4,f=o(r);a=65535;var c=o(t);return{chars1:f,chars2:c,lineArray:i}},p.prototype.diff_charsToLines_=function(r,t){for(var i=0;i<r.length;i++){for(var s=r[i][1],o=[],a=0;a<s.length;a++)o[a]=t[s.charCodeAt(a)];r[i][1]=o.join("")}},p.prototype.diff_commonPrefix=function(r,t){if(!r||!t||r.charAt(0)!=t.charAt(0))return 0;for(var i=0,s=Math.min(r.length,t.length),o=s,a=0;i<o;)r.substring(a,o)==t.substring(a,o)?(i=o,a=i):s=o,o=Math.floor((s-i)/2+i);return o},p.prototype.diff_commonSuffix=function(r,t){if(!r||!t||r.charAt(r.length-1)!=t.charAt(t.length-1))return 0;for(var i=0,s=Math.min(r.length,t.length),o=s,a=0;i<o;)r.substring(r.length-o,r.length-a)==t.substring(t.length-o,t.length-a)?(i=o,a=i):s=o,o=Math.floor((s-i)/2+i);return o},p.prototype.diff_commonOverlap_=function(r,t){var i=r.length,s=t.length;if(i==0||s==0)return 0;i>s?r=r.substring(i-s):i<s&&(t=t.substring(0,i));var o=Math.min(i,s);if(r==t)return o;for(var a=0,f=1;;){var c=r.substring(o-f),v=t.indexOf(c);if(v==-1)return a;f+=v,(v==0||r.substring(o-f)==t.substring(0,f))&&(a=f,f++)}},p.prototype.diff_halfMatch_=function(r,t){if(this.Diff_Timeout<=0)return null;var i=r.length>t.length?r:t,s=r.length>t.length?t:r;if(i.length<4||s.length*2<i.length)return null;var o=this;function a(E,I,U){for(var B=E.substring(U,U+Math.floor(E.length/4)),L=-1,P="",W,X,V,T;(L=I.indexOf(B,L+1))!=-1;){var N=o.diff_commonPrefix(E.substring(U),I.substring(L)),H=o.diff_commonSuffix(E.substring(0,U),I.substring(0,L));P.length<H+N&&(P=I.substring(L-H,L)+I.substring(L,L+N),W=E.substring(0,U-H),X=E.substring(U+N),V=I.substring(0,L-H),T=I.substring(L+N))}return P.length*2>=E.length?[W,X,V,T,P]:null}var f=a(i,s,Math.ceil(i.length/4)),c=a(i,s,Math.ceil(i.length/2)),v;if(!f&&!c)return null;c?f?v=f[4].length>c[4].length?f:c:v=c:v=f;var b,w,D,M;r.length>t.length?(b=v[0],w=v[1],D=v[2],M=v[3]):(D=v[0],M=v[1],b=v[2],w=v[3]);var k=v[4];return[b,w,D,M,k]},p.prototype.diff_cleanupSemantic=function(r){for(var t=!1,i=[],s=0,o=null,a=0,f=0,c=0,v=0,b=0;a<r.length;)r[a][0]==S?(i[s++]=a,f=v,c=b,v=0,b=0,o=r[a][1]):(r[a][0]==y?v+=r[a][1].length:b+=r[a][1].length,o&&o.length<=Math.max(f,c)&&o.length<=Math.max(v,b)&&(r.splice(i[s-1],0,new p.Diff(C,o)),r[i[s-1]+1][0]=y,s--,s--,a=s>0?i[s-1]:-1,f=0,c=0,v=0,b=0,o=null,t=!0)),a++;for(t&&this.diff_cleanupMerge(r),this.diff_cleanupSemanticLossless(r),a=1;a<r.length;){if(r[a-1][0]==C&&r[a][0]==y){var w=r[a-1][1],D=r[a][1],M=this.diff_commonOverlap_(w,D),k=this.diff_commonOverlap_(D,w);M>=k?(M>=w.length/2||M>=D.length/2)&&(r.splice(a,0,new p.Diff(S,D.substring(0,M))),r[a-1][1]=w.substring(0,w.length-M),r[a+1][1]=D.substring(M),a++):(k>=w.length/2||k>=D.length/2)&&(r.splice(a,0,new p.Diff(S,w.substring(0,k))),r[a-1][0]=y,r[a-1][1]=D.substring(0,D.length-k),r[a+1][0]=C,r[a+1][1]=w.substring(k),a++),a++}a++}},p.prototype.diff_cleanupSemanticLossless=function(r){function t(k,E){if(!k||!E)return 6;var I=k.charAt(k.length-1),U=E.charAt(0),B=I.match(p.nonAlphaNumericRegex_),L=U.match(p.nonAlphaNumericRegex_),P=B&&I.match(p.whitespaceRegex_),W=L&&U.match(p.whitespaceRegex_),X=P&&I.match(p.linebreakRegex_),V=W&&U.match(p.linebreakRegex_),T=X&&k.match(p.blanklineEndRegex_),N=V&&E.match(p.blanklineStartRegex_);return T||N?5:X||V?4:B&&!P&&W?3:P||W?2:B||L?1:0}for(var i=1;i<r.length-1;){if(r[i-1][0]==S&&r[i+1][0]==S){var s=r[i-1][1],o=r[i][1],a=r[i+1][1],f=this.diff_commonSuffix(s,o);if(f){var c=o.substring(o.length-f);s=s.substring(0,s.length-f),o=c+o.substring(0,o.length-f),a=c+a}for(var v=s,b=o,w=a,D=t(s,o)+t(o,a);o.charAt(0)===a.charAt(0);){s+=o.charAt(0),o=o.substring(1)+a.charAt(0),a=a.substring(1);var M=t(s,o)+t(o,a);M>=D&&(D=M,v=s,b=o,w=a)}r[i-1][1]!=v&&(v?r[i-1][1]=v:(r.splice(i-1,1),i--),r[i][1]=b,w?r[i+1][1]=w:(r.splice(i+1,1),i--))}i++}},p.nonAlphaNumericRegex_=/[^a-zA-Z0-9]/,p.whitespaceRegex_=/\s/,p.linebreakRegex_=/[\r\n]/,p.blanklineEndRegex_=/\n\r?\n$/,p.blanklineStartRegex_=/^\r?\n\r?\n/,p.prototype.diff_cleanupEfficiency=function(r){for(var t=!1,i=[],s=0,o=null,a=0,f=!1,c=!1,v=!1,b=!1;a<r.length;)r[a][0]==S?(r[a][1].length<this.Diff_EditCost&&(v||b)?(i[s++]=a,f=v,c=b,o=r[a][1]):(s=0,o=null),v=b=!1):(r[a][0]==C?b=!0:v=!0,o&&(f&&c&&v&&b||o.length<this.Diff_EditCost/2&&f+c+v+b==3)&&(r.splice(i[s-1],0,new p.Diff(C,o)),r[i[s-1]+1][0]=y,s--,o=null,f&&c?(v=b=!0,s=0):(s--,a=s>0?i[s-1]:-1,v=b=!1),t=!0)),a++;t&&this.diff_cleanupMerge(r)},p.prototype.diff_cleanupMerge=function(r){r.push(new p.Diff(S,""));for(var t=0,i=0,s=0,o="",a="",f;t<r.length;)switch(r[t][0]){case y:s++,a+=r[t][1],t++;break;case C:i++,o+=r[t][1],t++;break;case S:i+s>1?(i!==0&&s!==0&&(f=this.diff_commonPrefix(a,o),f!==0&&(t-i-s>0&&r[t-i-s-1][0]==S?r[t-i-s-1][1]+=a.substring(0,f):(r.splice(0,0,new p.Diff(S,a.substring(0,f))),t++),a=a.substring(f),o=o.substring(f)),f=this.diff_commonSuffix(a,o),f!==0&&(r[t][1]=a.substring(a.length-f)+r[t][1],a=a.substring(0,a.length-f),o=o.substring(0,o.length-f))),t-=i+s,r.splice(t,i+s),o.length&&(r.splice(t,0,new p.Diff(C,o)),t++),a.length&&(r.splice(t,0,new p.Diff(y,a)),t++),t++):t!==0&&r[t-1][0]==S?(r[t-1][1]+=r[t][1],r.splice(t,1)):t++,s=0,i=0,o="",a="";break}r[r.length-1][1]===""&&r.pop();var c=!1;for(t=1;t<r.length-1;)r[t-1][0]==S&&r[t+1][0]==S&&(r[t][1].substring(r[t][1].length-r[t-1][1].length)==r[t-1][1]?(r[t][1]=r[t-1][1]+r[t][1].substring(0,r[t][1].length-r[t-1][1].length),r[t+1][1]=r[t-1][1]+r[t+1][1],r.splice(t-1,1),c=!0):r[t][1].substring(0,r[t+1][1].length)==r[t+1][1]&&(r[t-1][1]+=r[t+1][1],r[t][1]=r[t][1].substring(r[t+1][1].length)+r[t+1][1],r.splice(t+1,1),c=!0)),t++;c&&this.diff_cleanupMerge(r)},p.prototype.diff_xIndex=function(r,t){var i=0,s=0,o=0,a=0,f;for(f=0;f<r.length&&(r[f][0]!==y&&(i+=r[f][1].length),r[f][0]!==C&&(s+=r[f][1].length),!(i>t));f++)o=i,a=s;return r.length!=f&&r[f][0]===C?a:a+(t-o)},p.prototype.diff_prettyHtml=function(r){for(var t=[],i=/&/g,s=/</g,o=/>/g,a=/\n/g,f=0;f<r.length;f++){var c=r[f][0],v=r[f][1],b=v.replace(i,"&amp;").replace(s,"&lt;").replace(o,"&gt;").replace(a,"&para;<br>");switch(c){case y:t[f]='<ins style="background:#e6ffe6;">'+b+"</ins>";break;case C:t[f]='<del style="background:#ffe6e6;">'+b+"</del>";break;case S:t[f]="<span>"+b+"</span>";break}}return t.join("")},p.prototype.diff_text1=function(r){for(var t=[],i=0;i<r.length;i++)r[i][0]!==y&&(t[i]=r[i][1]);return t.join("")},p.prototype.diff_text2=function(r){for(var t=[],i=0;i<r.length;i++)r[i][0]!==C&&(t[i]=r[i][1]);return t.join("")},p.prototype.diff_levenshtein=function(r){for(var t=0,i=0,s=0,o=0;o<r.length;o++){var a=r[o][0],f=r[o][1];switch(a){case y:i+=f.length;break;case C:s+=f.length;break;case S:t+=Math.max(i,s),i=0,s=0;break}}return t+=Math.max(i,s),t},p.prototype.diff_toDelta=function(r){for(var t=[],i=0;i<r.length;i++)switch(r[i][0]){case y:t[i]="+"+encodeURI(r[i][1]);break;case C:t[i]="-"+r[i][1].length;break;case S:t[i]="="+r[i][1].length;break}return t.join("	").replace(/%20/g," ")},p.prototype.diff_fromDelta=function(r,t){for(var i=[],s=0,o=0,a=t.split(/\t/g),f=0;f<a.length;f++){var c=a[f].substring(1);switch(a[f].charAt(0)){case"+":try{i[s++]=new p.Diff(y,decodeURI(c))}catch{throw new Error("Illegal escape in diff_fromDelta: "+c)}break;case"-":case"=":var v=parseInt(c,10);if(isNaN(v)||v<0)throw new Error("Invalid number in diff_fromDelta: "+c);var b=r.substring(o,o+=v);a[f].charAt(0)=="="?i[s++]=new p.Diff(S,b):i[s++]=new p.Diff(C,b);break;default:if(a[f])throw new Error("Invalid diff operation in diff_fromDelta: "+a[f])}}if(o!=r.length)throw new Error("Delta length ("+o+") does not equal source text length ("+r.length+").");return i},p.prototype.match_main=function(r,t,i){if(r==null||t==null||i==null)throw new Error("Null input. (match_main)");return i=Math.max(0,Math.min(i,r.length)),r==t?0:r.length?r.substring(i,i+t.length)==t?i:this.match_bitap_(r,t,i):-1},p.prototype.match_bitap_=function(r,t,i){if(t.length>this.Match_MaxBits)throw new Error("Pattern too long for this browser.");var s=this.match_alphabet_(t),o=this;function a(W,X){var V=W/t.length,T=Math.abs(i-X);return o.Match_Distance?V+T/o.Match_Distance:T?1:V}var f=this.Match_Threshold,c=r.indexOf(t,i);c!=-1&&(f=Math.min(a(0,c),f),c=r.lastIndexOf(t,i+t.length),c!=-1&&(f=Math.min(a(0,c),f)));var v=1<<t.length-1;c=-1;for(var b,w,D=t.length+r.length,M,k=0;k<t.length;k++){for(b=0,w=D;b<w;)a(k,i+w)<=f?b=w:D=w,w=Math.floor((D-b)/2+b);D=w;var E=Math.max(1,i-w+1),I=Math.min(i+w,r.length)+t.length,U=Array(I+2);U[I+1]=(1<<k)-1;for(var B=I;B>=E;B--){var L=s[r.charAt(B-1)];if(k===0?U[B]=(U[B+1]<<1|1)&L:U[B]=(U[B+1]<<1|1)&L|((M[B+1]|M[B])<<1|1)|M[B+1],U[B]&v){var P=a(k,B-1);if(P<=f)if(f=P,c=B-1,c>i)E=Math.max(1,2*i-c);else break}}if(a(k+1,i)>f)break;M=U}return c},p.prototype.match_alphabet_=function(r){for(var t={},i=0;i<r.length;i++)t[r.charAt(i)]=0;for(var i=0;i<r.length;i++)t[r.charAt(i)]|=1<<r.length-i-1;return t},p.prototype.patch_addContext_=function(r,t){if(t.length!=0){if(r.start2===null)throw Error("patch not initialized");for(var i=t.substring(r.start2,r.start2+r.length1),s=0;t.indexOf(i)!=t.lastIndexOf(i)&&i.length<this.Match_MaxBits-this.Patch_Margin-this.Patch_Margin;)s+=this.Patch_Margin,i=t.substring(r.start2-s,r.start2+r.length1+s);s+=this.Patch_Margin;var o=t.substring(r.start2-s,r.start2);o&&r.diffs.unshift(new p.Diff(S,o));var a=t.substring(r.start2+r.length1,r.start2+r.length1+s);a&&r.diffs.push(new p.Diff(S,a)),r.start1-=o.length,r.start2-=o.length,r.length1+=o.length+a.length,r.length2+=o.length+a.length}},p.prototype.patch_make=function(r,t,i){var s,o;if(typeof r=="string"&&typeof t=="string"&&typeof i>"u")s=r,o=this.diff_main(s,t,!0),o.length>2&&(this.diff_cleanupSemantic(o),this.diff_cleanupEfficiency(o));else if(r&&typeof r=="object"&&typeof t>"u"&&typeof i>"u")o=r,s=this.diff_text1(o);else if(typeof r=="string"&&t&&typeof t=="object"&&typeof i>"u")s=r,o=t;else if(typeof r=="string"&&typeof t=="string"&&i&&typeof i=="object")s=r,o=i;else throw new Error("Unknown call format to patch_make.");if(o.length===0)return[];for(var a=[],f=new p.patch_obj,c=0,v=0,b=0,w=s,D=s,M=0;M<o.length;M++){var k=o[M][0],E=o[M][1];switch(!c&&k!==S&&(f.start1=v,f.start2=b),k){case y:f.diffs[c++]=o[M],f.length2+=E.length,D=D.substring(0,b)+E+D.substring(b);break;case C:f.length1+=E.length,f.diffs[c++]=o[M],D=D.substring(0,b)+D.substring(b+E.length);break;case S:E.length<=2*this.Patch_Margin&&c&&o.length!=M+1?(f.diffs[c++]=o[M],f.length1+=E.length,f.length2+=E.length):E.length>=2*this.Patch_Margin&&c&&(this.patch_addContext_(f,w),a.push(f),f=new p.patch_obj,c=0,w=D,v=b);break}k!==y&&(v+=E.length),k!==C&&(b+=E.length)}return c&&(this.patch_addContext_(f,w),a.push(f)),a},p.prototype.patch_deepCopy=function(r){for(var t=[],i=0;i<r.length;i++){var s=r[i],o=new p.patch_obj;o.diffs=[];for(var a=0;a<s.diffs.length;a++)o.diffs[a]=new p.Diff(s.diffs[a][0],s.diffs[a][1]);o.start1=s.start1,o.start2=s.start2,o.length1=s.length1,o.length2=s.length2,t[i]=o}return t},p.prototype.patch_apply=function(r,t){if(r.length==0)return[t,[]];r=this.patch_deepCopy(r);var i=this.patch_addPadding(r);t=i+t+i,this.patch_splitMax(r);for(var s=0,o=[],a=0;a<r.length;a++){var f=r[a].start2+s,c=this.diff_text1(r[a].diffs),v,b=-1;if(c.length>this.Match_MaxBits?(v=this.match_main(t,c.substring(0,this.Match_MaxBits),f),v!=-1&&(b=this.match_main(t,c.substring(c.length-this.Match_MaxBits),f+c.length-this.Match_MaxBits),(b==-1||v>=b)&&(v=-1))):v=this.match_main(t,c,f),v==-1)o[a]=!1,s-=r[a].length2-r[a].length1;else{o[a]=!0,s=v-f;var w;if(b==-1?w=t.substring(v,v+c.length):w=t.substring(v,b+this.Match_MaxBits),c==w)t=t.substring(0,v)+this.diff_text2(r[a].diffs)+t.substring(v+c.length);else{var D=this.diff_main(c,w,!1);if(c.length>this.Match_MaxBits&&this.diff_levenshtein(D)/c.length>this.Patch_DeleteThreshold)o[a]=!1;else{this.diff_cleanupSemanticLossless(D);for(var M=0,k,E=0;E<r[a].diffs.length;E++){var I=r[a].diffs[E];I[0]!==S&&(k=this.diff_xIndex(D,M)),I[0]===y?t=t.substring(0,v+k)+I[1]+t.substring(v+k):I[0]===C&&(t=t.substring(0,v+k)+t.substring(v+this.diff_xIndex(D,M+I[1].length))),I[0]!==C&&(M+=I[1].length)}}}}}return t=t.substring(i.length,t.length-i.length),[t,o]},p.prototype.patch_addPadding=function(r){for(var t=this.Patch_Margin,i="",s=1;s<=t;s++)i+=String.fromCharCode(s);for(var s=0;s<r.length;s++)r[s].start1+=t,r[s].start2+=t;var o=r[0],a=o.diffs;if(a.length==0||a[0][0]!=S)a.unshift(new p.Diff(S,i)),o.start1-=t,o.start2-=t,o.length1+=t,o.length2+=t;else if(t>a[0][1].length){var f=t-a[0][1].length;a[0][1]=i.substring(a[0][1].length)+a[0][1],o.start1-=f,o.start2-=f,o.length1+=f,o.length2+=f}if(o=r[r.length-1],a=o.diffs,a.length==0||a[a.length-1][0]!=S)a.push(new p.Diff(S,i)),o.length1+=t,o.length2+=t;else if(t>a[a.length-1][1].length){var f=t-a[a.length-1][1].length;a[a.length-1][1]+=i.substring(0,f),o.length1+=f,o.length2+=f}return i},p.prototype.patch_splitMax=function(r){for(var t=this.Match_MaxBits,i=0;i<r.length;i++)if(!(r[i].length1<=t)){var s=r[i];r.splice(i--,1);for(var o=s.start1,a=s.start2,f="";s.diffs.length!==0;){var c=new p.patch_obj,v=!0;for(c.start1=o-f.length,c.start2=a-f.length,f!==""&&(c.length1=c.length2=f.length,c.diffs.push(new p.Diff(S,f)));s.diffs.length!==0&&c.length1<t-this.Patch_Margin;){var b=s.diffs[0][0],w=s.diffs[0][1];b===y?(c.length2+=w.length,a+=w.length,c.diffs.push(s.diffs.shift()),v=!1):b===C&&c.diffs.length==1&&c.diffs[0][0]==S&&w.length>2*t?(c.length1+=w.length,o+=w.length,v=!1,c.diffs.push(new p.Diff(b,w)),s.diffs.shift()):(w=w.substring(0,t-c.length1-this.Patch_Margin),c.length1+=w.length,o+=w.length,b===S?(c.length2+=w.length,a+=w.length):v=!1,c.diffs.push(new p.Diff(b,w)),w==s.diffs[0][1]?s.diffs.shift():s.diffs[0][1]=s.diffs[0][1].substring(w.length))}f=this.diff_text2(c.diffs),f=f.substring(f.length-this.Patch_Margin);var D=this.diff_text1(s.diffs).substring(0,this.Patch_Margin);D!==""&&(c.length1+=D.length,c.length2+=D.length,c.diffs.length!==0&&c.diffs[c.diffs.length-1][0]===S?c.diffs[c.diffs.length-1][1]+=D:c.diffs.push(new p.Diff(S,D))),v||r.splice(++i,0,c)}}},p.prototype.patch_toText=function(r){for(var t=[],i=0;i<r.length;i++)t[i]=r[i];return t.join("")},p.prototype.patch_fromText=function(r){var t=[];if(!r)return t;for(var i=r.split(`
`),s=0,o=/^@@ -(\d+),?(\d*) \+(\d+),?(\d*) @@$/;s<i.length;){var a=i[s].match(o);if(!a)throw new Error("Invalid patch string: "+i[s]);var f=new p.patch_obj;for(t.push(f),f.start1=parseInt(a[1],10),a[2]===""?(f.start1--,f.length1=1):a[2]=="0"?f.length1=0:(f.start1--,f.length1=parseInt(a[2],10)),f.start2=parseInt(a[3],10),a[4]===""?(f.start2--,f.length2=1):a[4]=="0"?f.length2=0:(f.start2--,f.length2=parseInt(a[4],10)),s++;s<i.length;){var c=i[s].charAt(0);try{var v=decodeURI(i[s].substring(1))}catch{throw new Error("Illegal escape in patch_fromText: "+v)}if(c=="-")f.diffs.push(new p.Diff(C,v));else if(c=="+")f.diffs.push(new p.Diff(y,v));else if(c==" ")f.diffs.push(new p.Diff(S,v));else{if(c=="@")break;if(c!=="")throw new Error('Invalid patch mode "'+c+'" in: '+v)}s++}}return t},p.patch_obj=function(){this.diffs=[],this.start1=null,this.start2=null,this.length1=0,this.length2=0},p.patch_obj.prototype.toString=function(){var r,t;this.length1===0?r=this.start1+",0":this.length1==1?r=this.start1+1:r=this.start1+1+","+this.length1,this.length2===0?t=this.start2+",0":this.length2==1?t=this.start2+1:t=this.start2+1+","+this.length2;for(var i=["@@ -"+r+" +"+t+` @@
`],s,o=0;o<this.diffs.length;o++){switch(this.diffs[o][0]){case y:s="+";break;case C:s="-";break;case S:s=" ";break}i[o+1]=s+encodeURI(this.diffs[o][1])+`
`}return i.join("").replace(/%20/g," ")},ee.exports=p,ee.exports.diff_match_patch=p,ee.exports.DIFF_DELETE=C,ee.exports.DIFF_INSERT=y,ee.exports.DIFF_EQUAL=S})($e);const dr=$e.exports,q=Re({folders:[],item:{}}),_r={class:"content_area"},br={name:"CompareEditor"},wr=ye({...br,setup(ee){const p=De("contentIdentity"),C=De("contentName");window.diff_match_patch=dr,window.DIFF_DELETE=-1,window.DIFF_INSERT=1,window.DIFF_EQUAL=0,gr(q,p,["content"],C);const y=Re({value:"",origLeft:null,orig:"",connect:"align",mode:"text/html",theme:ar[j.theme.current],lineNumbers:!0,collapseIdentical:!1,highlightDifferences:!0,allowEditingOriginals:!0});lr(()=>{const{content:r}=q.item[p.value];r.useThreeWay?r.diff||(r.diff=r.content.replace("yellow","orange")):r.diff=null,y.value=r.content,y.origLeft=r.diff,y.orig=r.compare});function S(r){const{content:t}=q.item[p.value],{type:i,data:s}=r;switch(i){case"value":t.useThreeWay?t.diff=s:t.content=s;break;case"left":t.useThreeWay&&(t.content=s);break;case"right":t.compare=s;break}}return(r,t)=>(ne(),pe("div",_r,[x(ir,{"is-merge":!0,options:y,"textarea-key":"refCompare",events:[],onChange:S},null,8,["options"])]))}});const Cr=Ue(wr,[["__scopeId","data-v-f1b2e77b"]]),me=".compare",Dr={[ve.Config]:"compare_config",[ve.Folder]:"compare_folder",[ve.Content]:"compare_content",[ve.Env]:"compare_env"};function kr(){return{content:{useThreeWay:!1,content:"",compare:"",diff:null},isSaved:0}}const yr={class:"warp_bigger compare_area"},Mr={key:0,class:"show_area"},Sr={class:"tw-flex tw-justify-end tw-items-center"},Fr={key:0},Tr={class:"tw-ml-4"},Ar={class:"tw-ml-4"},Er={class:"tw-ml-2"},Ir={class:"tw-mr-1"},Br={name:"ModuleCompare"},Lr=ye({...Br,setup(ee){const p=De("storeIDB"),{curContentIdentity:C,curContentName:y,curContentFolderIdentity:S,curFolders:r,curHistoryFolders:t,curIsSaved:i,addFolder:s,renameFolder:o,deleteFolder:a,sortFolder:f,createContent:c,saveContent:v,showContent:b,renameContent:w,copyContent:D,deleteContent:M,autoSaveContent:k,importContent:E,getContent:I,saveFolder:U,saveContentItem:B}=cr(p,Dr,q,kr());K("contentIsSaved",i),K("contentFolderIdentity",S),K("contentIdentity",C),K("contentName",y),K("historyFolders",t),K("folders",r),K("addFolder",s),K("renameFolder",o),K("deleteFolder",a),K("showContent",b),K("copyContent",D),K("renameContent",w),K("deleteContent",M),K("sortFolder",f),K("saveContent",v),K("autoSaveContent",k),K("getContent",I),K("saveFolder",U),K("saveContentItem",B);function L(){c()}function P(T){j.loading=!0;const{name:N,content:H,isSave:re,folderIdentity:he}=T;E(N,H,re,he,me).then(()=>{j.loading=!1}).catch(()=>{j.loading=!1})}let W;(T=>{T.Left="left",T.Middle="middle",T.Right="right"})(W||(W={}));const X=sr(()=>{const T=[{value:"left",label:ie("compare.copy.left")},{value:"right",label:ie("compare.copy.right")}];return q.item[C.value].content.useThreeWay&&T.push({value:"middle",label:ie("compare.copy.middle")}),T});function V(T){const{content:N,compare:H,diff:re}=q.item[C.value].content;T==="left"?Ce(N||""):T==="middle"?Ce(re||""):Ce(H||"")}return(T,N)=>(ne(),pe("div",yr,[x(rr,{collapse:R(j).historyDrawer.collapse,"onUpdate:collapse":N[3]||(N[3]=H=>R(j).historyDrawer.collapse=H),history:R(j).historyDrawer,suffix:R(me)},{default:oe(()=>[R(C)?(ne(),pe("div",Mr,[x(tr,{title:R(ie)(`module.${R(j).module}`),contentName:R(y),"onUpdate:contentName":N[2]||(N[2]=H=>or(y)?y.value=H:null),"is-has-name":!0},{titleRight:oe(()=>[fe("div",Sr,[R(C)?(ne(),pe("span",Fr,[x(Ye,{"store-item-data":R(q).item[R(C)]},null,8,["store-item-data"])])):we("",!0),fe("span",Tr,[x(vr,{checked:R(q).item[R(C)].content.useThreeWay,"onUpdate:checked":N[0]||(N[0]=H=>R(q).item[R(C)].content.useThreeWay=H),name:R(ie)("compare.threeWay")},null,8,["checked","name"])]),fe("span",Ar,[x(je,{"support-types":["text/plain"],accept:[R(me)],"store-item-data":R(q).item[R(C)],suffix:R(me),onSelect:L,onContent:P},null,8,["accept","store-item-data","suffix"])]),fe("span",Er,[x(qe,{data:X.value,onSelected:V},{anchor:oe(()=>[x(ur,{type:"primary"},{default:oe(()=>[fe("span",Ir,fr(R(ie)("tags.copy")),1),x(mr,{type:R(pr).DownOutlined,size:"xs"},null,8,["type"])]),_:1})]),_:1},8,["data"])]),x(xe,hr({class:"tw-ml-2"},T.$attrs),null,16),R(j).historyDrawer.collapse?(ne(),ke(er,{key:1,class:"tw-ml-2",visible:R(j).historyDrawer.visible,"onUpdate:visible":N[1]||(N[1]=H=>R(j).historyDrawer.visible=H)},null,8,["visible"])):we("",!0)])]),default:oe(()=>[(ne(),ke(Cr,{key:`${R(C)}_${R(q).item[R(C)].content.useThreeWay}`}))]),_:1},8,["title","contentName"])])):we("",!0)]),_:1},8,["collapse","history","suffix"])]))}});const Nr=Ue(Lr,[["__scopeId","data-v-f6f0c522"]]),ut=ye({__name:"Compare",setup(ee){return(p,C)=>(ne(),ke(Nr))}});export{ut as default};
