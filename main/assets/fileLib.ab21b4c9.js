import{ah as p,ai as w,aj as v}from"./index.1da778f9.js";const E=["image/*"];function F(t,i=!0){return new Promise((a,n)=>{if(typeof FileReader<"u"){const e=new FileReader;e.onload=function(o){const c={src:"",canvasSource:null,height:0,width:0};R(o.target.result).then(l=>{const{canvas:r,canvasSource:u}=l;c.src=i?y(r):o.target.result,c.canvasSource=u||null,a(c)})},e.readAsDataURL(t),e.onerror=o=>{console.log("error-readImageAsDataUrl",o),n("no support FileReader")}}else n("no support FileReader")})}function R(t){return new Promise((i,a)=>{const n=document.createElement("canvas");if(t){const e=new Image;e.src=t,e.onload=()=>{n.width=e.width,n.height=e.height,n.getContext("2d").drawImage(e,0,0,e.width,e.height),i({canvasSource:e,canvas:n,height:e.height,width:e.width})},e.onerror=o=>{a(o)}}else n.width=0,n.height=0,i({canvas:n,height:0,width:0})})}function y(t){return t.toDataURL("image/png")}function U(t,i,a=100,n=0,e=0,o){return new Promise((c,l)=>{const r=o||document.createElement("canvas");r.width=n,r.height=e;const u=r.getContext("2d");u.clearRect(0,0,r.width,r.height),u.drawImage(t,0,0,n,e),r.toBlob(d=>{let f="";d&&(f=URL.createObjectURL(d)),c({blobUrl:f,blob:d})},i,a)})}function m(t,i){return new Promise((a,n)=>{try{const e=document.createElement("a");if(e.setAttribute("href","data:text/plain;charset=UTF-8,"+encodeURIComponent(t)),e.setAttribute("download",i),e.style.display="none",document.createEvent){const o=document.createEvent("MouseEvents");o.initEvent("click",!0,!0),e.dispatchEvent(o)}else e.click();a("")}catch(e){n(e)}})}function b(t,i,a=""){return m(t,`${i}${a}`)}function C(t,i,a=""){const n=`<!DOCTYPE html><head><meta charset="UTF-8"><title>${i}</title></head><body>${t}</body></html>`;return m(n,`${i}${a}`)}function I(t,i){window.open(`#/preview/${t}/${i}`)}function A(t){return new Promise((i,a)=>{if(typeof FileReader<"u"){const n=new FileReader;n.readAsText(t,"utf-8"),n.onload=function(e){i(n.result)},n.onerror=e=>{a(e)}}else a("no support FileReader")})}function T(t){return A(t)}function L(t){let i="";const a=p(t,".");return a.length>1&&(i=`.${w(a[a.length-1])}`),i}function x(t,i){let a=!1;return t?v(i,n=>{let e="";if(n.indexOf("*")>-1&&(e=n.replaceAll("*","")),e?t.indexOf(e)>-1&&(a=!0):a=!0,a)return!1}):a=!0,a}function $(t,i,a=!1){return new Promise((n,e)=>{var o;if(!((o=t==null?void 0:t.clipboardData)!=null&&o.items))e("");else{const c=t.clipboardData.items.length;for(let l=0;l<c;l++){const r=t.clipboardData.items[l],{kind:u,type:d}=r;if(u==="file"&&(console.log("--type",d),x(d,i))){const h=r.getAsFile();t.preventDefault(),a?F(h).then(s=>{const{src:g}=s;n(g)}).catch(s=>{e(s),console.log("importFile-err",s)}):T(h).then(s=>{n(s)}).catch(s=>{e(s),console.log("importFile-err",s)})}}}})}export{I as a,C as b,E as c,x as d,m as e,R as f,L as g,U as h,T as i,$ as p,F as r,b as s};
