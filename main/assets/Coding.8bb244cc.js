import{q as U,d as $,K as b,o as c,c as C,x as y,a1 as B,$ as t,bg as rt,a4 as n,S as e,t as at,aj as N,di as it,a as m,w,g as D,av as dt,v as I,y as F}from"./index.1da778f9.js";import{D as ct,C as E,c as u,i as lt,a as mt,E as pt}from"./DCodeMirror.4be9c467.js";import{U as ut}from"./UIWithTitle.f8208f61.js";import{b as _t,c as ft,d as Ct,e as yt,U as gt}from"./UICreateImport.vue_vue_type_script_setup_true_lang.e9d5def8.js";import{_ as vt}from"./DButton.vue_vue_type_script_setup_true_lang.7d1596b6.js";import{d as ht}from"./copyLib.da4e3454.js";import{u as xt}from"./ModuleAutoSaveLib.0fb4c3e5.js";import{_ as M}from"./_plugin-vue_export-helper.cdc0426e.js";import{u as wt}from"./PortImport.vue_vue_type_script_setup_true_lang.2fc96ef8.js";import{g as It}from"./fileLib.ab21b4c9.js";import"./DTooltip.63413dc2.js";import"./Interface.adbaf245.js";import"./_baseIsEqual.74295246.js";import"./DSelect.vue_vue_type_script_setup_true_lang.5279f391.js";import"./KeyCode.9e37adda.js";import"./codemirror.a85cc932.js";import"./ModuleCollapsetLib.78fb6d31.js";import"./routeLib.b1a3bf91.js";import"./findIndex.4ace8958.js";import"./hasIn.49cbec25.js";import"./memoize.9cfb9d7d.js";import"./index.5aa88714.js";import"./pick.5cf82e83.js";import"./_flatRest.4c2f6287.js";import"./styleChecker.0a18f775.js";import"./debounce.64b6b86f.js";import"./now.5c01924d.js";import"./trim.8795fa7a.js";import"./DSpin.61091bf0.js";import"./DResult.vue_vue_type_script_setup_true_lang.65015d34.js";import"./config.aa76b2c0.js";import"./randomLib.04c6c9cc.js";import"./stringify.15412eb9.js";const d=U({folders:[],item:{}}),Ft={class:"coding-content"},bt={name:"CodingEditor"},$t=$({...bt,setup(S){const s=b("contentIdentity"),_=b("contentName");return xt(d,s,["content"],_),(a,i)=>(c(),C("div",Ft,[(c(),y(ct,B(a.$attrs,{"is-use-format":!0,"is-use-border":!0,"is-select-mode":!0,key:t(s),theme:t(rt)[t(n).theme.current],"textarea-key":t(s),value:t(d).item[t(s)].content.content,"onUpdate:value":i[0]||(i[0]=p=>t(d).item[t(s)].content.content=p),mode:t(d).item[t(s)].content.mode,"onUpdate:mode":i[1]||(i[1]=p=>t(d).item[t(s)].content.mode=p)}),null,16,["theme","textarea-key","value","mode"]))]))}});const St=M($t,[["__scopeId","data-v-03bd1bb0"]]),kt={class:"warp_bigger coding_area"},Nt={key:0,class:"show_area"},Dt={class:"tw-flex tw-justify-end tw-items-center"},Et={key:0},Ut={class:"tw-ml-2"},Bt={class:"tw-ml-2"},Mt={name:"ModuleCoding"},Tt=$({...Mt,setup(S){const s=b("storeIDB"),{curIsSaved:_,curContentIdentity:a,curContentName:i,curContentFolderIdentity:p,curFolders:T,curHistoryFolders:j,addFolder:A,renameFolder:V,deleteFolder:L,sortFolder:R,createContent:q,saveContent:H,showContent:K,renameContent:P,copyContent:W,deleteContent:z,autoSaveContent:G,importContent:J,getContent:O,saveFolder:Q,saveContentItem:X}=wt(s,mt,d,lt());e("contentIsSaved",_),e("contentFolderIdentity",p),e("contentIdentity",a),e("contentName",i),e("historyFolders",j),e("folders",T),e("addFolder",A),e("renameFolder",V),e("deleteFolder",L),e("showContent",K),e("copyContent",W),e("renameContent",P),e("deleteContent",z),e("sortFolder",R),e("saveContent",H),e("autoSaveContent",G),e("getContent",O),e("saveFolder",Q),e("saveContentItem",X);const f=U({support:[],accept:""});at(()=>{let l=[],o=[];N(E,r=>{const{suffixes:g,types:v}=r;l=[...l,...v],o=[...o,...g]}),f.support=l,f.accept=it(o,",")+`,${u}`});function Y(){q()}function Z(l){n.loading=!0;const{name:o,content:r,type:g,isSave:v,folderIdentity:et}=l;let h=It(o),x;if(h!==u){let k="";N(E,(nt,st)=>{if(nt.types.includes(g))return k=st,!1});const ot=k||pt.Text;x={content:r,mode:ot,suffix:{origin:h,current:h}}}else x=r;J(o,x,v,et,u).then(()=>{n.loading=!1}).catch(()=>{n.loading=!1})}function tt(){ht(d.item[a.value].content.content||"")}return(l,o)=>(c(),C("div",kt,[m(gt,{collapse:t(n).historyDrawer.collapse,"onUpdate:collapse":o[2]||(o[2]=r=>t(n).historyDrawer.collapse=r),history:t(n).historyDrawer,suffix:t(u)},{default:w(()=>[t(a)?(c(),C("div",Nt,[m(ut,{title:t(D)(`module.${t(n).module}`),contentName:t(i),"onUpdate:contentName":o[1]||(o[1]=r=>dt(i)?i.value=r:null),"is-has-name":!0},{titleRight:w(()=>[I("div",Dt,[t(a)?(c(),C("span",Et,[m(_t,{"store-item-data":t(d).item[t(a)]},null,8,["store-item-data"])])):F("",!0),I("span",Ut,[m(ft,{"support-types":f.support,accept:f.accept,"store-item-data":t(d).item[t(a)],suffix:t(u),"is-use-export-use":!0,onSelect:Y,onContent:Z},null,8,["support-types","accept","store-item-data","suffix"])]),I("span",Bt,[m(vt,{type:"primary",name:t(D)("tags.copy"),onClick:tt},null,8,["name"])]),m(Ct,B({class:"tw-ml-2"},l.$attrs),null,16),t(n).historyDrawer.collapse?(c(),y(yt,{key:1,class:"tw-ml-2",visible:t(n).historyDrawer.visible,"onUpdate:visible":o[0]||(o[0]=r=>t(n).historyDrawer.visible=r)},null,8,["visible"])):F("",!0)])]),default:w(()=>[(c(),y(St,{key:t(a)}))]),_:1},8,["title","contentName"])])):F("",!0)]),_:1},8,["collapse","history","suffix"])]))}});const jt=M(Tt,[["__scopeId","data-v-856d258f"]]),Ce=$({__name:"Coding",setup(S){return(s,_)=>(c(),y(jt))}});export{Ce as default};
