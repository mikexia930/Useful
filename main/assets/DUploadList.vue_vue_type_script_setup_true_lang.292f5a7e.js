import{c as g,r as h,d as _}from"./fileLib.ab21b4c9.js";import{_ as w}from"./DButton.vue_vue_type_script_setup_true_lang.7d1596b6.js";import{D as U}from"./DUpload.d86a41a8.js";import{d as y,s as f,o as C,x,w as D,ag as F,a as k,a1 as z}from"./index.1da778f9.js";const S={name:"DUploadList"},L=y({...S,props:{maxSize:{default:20},allowTypes:{default:()=>g},isConvertImage:{type:Boolean,default:!0}},emits:["error","file"],setup(u,{emit:s}){const i=u,o=f([]),t=f("");function p(){if(o.value.length>0){const{originFileObj:e}=o.value[0];e&&m(e)?h(e,i.isConvertImage).then(a=>{const{src:r,canvasSource:l}=a;t.value=r,c(e,l)}).catch(()=>{n(),s("error","file error")}):(n(),s("error","file error"))}else t.value="",c("")}function n(){t.value="",o.value=[]}function c(e,a){s("file",{previewUrl:t.value,file:e,image:a})}function m(e){const{maxSize:a,allowTypes:r}=i,l=_(e.type,r),v=e.size/1024/1024>a;return l&&!v}const d=()=>!1;return(e,a)=>(C(),x(U,z(e.$attrs,{"file-list":o.value,"onUpdate:fileList":a[0]||(a[0]=r=>o.value=r),"show-upload-list":!1,"max-count":1,"before-upload":d,onChange:p}),{default:D(()=>[F(e.$slots,"default",{},()=>[k(w,{name:"Upload"})])]),_:3},16,["file-list"]))}});export{L as _};
